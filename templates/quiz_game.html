{% extends "base.html" %}

{% block title %}Квиз{% endblock %}

{% block content %}
    <div class="panel">
        <div class="panel-header text-center">
            <div class="panel-title h5 mt-10">
                Вопрос {{ current_question_num }} из {{ total_questions }}
            </div>
        </div>
        <div class="panel-body">
            {# Блок для сообщения обратной связи #}
            {% if feedback_message %}
                <div class="toast {% if feedback_message == 'Верно!' %}toast-success{% else %}toast-error{% endif %}">
                    {{ feedback_message }}
                    {% if correct_answer_text %}
                        Правильный ответ был: {{ question.correct_answer }}. {{ correct_answer_text }}
                    {% endif %}
                </div>
            {% endif %}

            {% if question.image_url %}
                <div class="text-center my-2">
                    <img src="{{ question.image_url }}" alt="Изображение к вопросу" class="img-responsive" style="max-height: 300px; object-fit: contain;">
                </div>
            {% endif %}
            <p class="h6">{{ question.question_text }}</p>
            <form action="{{ url_for('quiz_game') }}" method="POST">
                {# Итерируем по перемешанному списку пар (ключ, значение) #}
                {% for original_key, value in answer_options %}
                    {# Генерируем новую букву для отображения (A, B, C, D) на основе индекса в цикле #}
                    {% set display_letter = (65 + loop.index0)|chr %}
                    <div class="form-group">
                        <label class="form-radio">
                            {# Важно: value="{{ original_key }}" - отправляем на сервер оригинальную букву ответа #}
                            <input type="radio" name="answer" value="{{ original_key }}" required>
                            <i class="form-icon"></i> {{ display_letter }}. {{ value }} {# Отображаем новую букву #}
                        </label>
                    </div>
                {% endfor %}
                <div class="form-group text-center mt-2">
                    <button type="submit" class="btn btn-primary btn-lg">Ответить</button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}